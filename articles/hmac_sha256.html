<span class = "content_title"> <a href="#/cpp"> C++</a> / <span class = "content_title_current">HMAC SHA-256, something about bit level data operations and stopwatch</span> </span>
<hr/>
<br/>

<div>
&emsp;For one of my projects related to API networking where I used <a class="external_link" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/winhttp/using-the-winhttp-c-c---api" >WinHTTP</a> and <a class="external_link" target="_blank" href="https://doc.qt.io/qt-6/qtnetwork-index.html" >QT Network</a> later, I've decided to add HMAC SHA-256 encryption function myself to not use ready solution but learn something more about how it's designed and because it's a great opportunity for data manipulation practice. <br/>

&emsp;HMAC is an abbrevation for "Hash-based Message Authentication Code" which purpose is to keep both authenticity and integrity of the message by generating one way shortened hash string with specified hash function using secret-key that is only known for sender and receiver.<br/>

&emsp;SHA-256 is Secure Hash Algorithm belonging to SHA-2 family which is considered currently as very safe, especially in such case when it's generated right before sending the message.<br>
Lot of knowledge I've found on this helpful site: <a class="external_link" target="_blank" href="https://blog.boot.dev/cryptography/hmac-and-macs-in-jwts" >HMAC blog.boot.dev</a> / <a class="external_link" target="_blank" href="https://blog.boot.dev/cryptography/how-sha-2-works-step-by-step-sha-256" >SHA-256 blog.boot.dev</a> but also I've learned from official sources: <a class="external_link" target="_blank" href="https://csrc.nist.gov/publications/detail/fips/198/1/final" >HMAC csrc.nist.gov</a> /  <a class="internal_link" href="/documents/NIST.FIPS.198-1.pdf">NIST.FIPS.198-1.pdf local download</a>  and <a class="external_link" target="_blank" href="https://csrc.nist.gov/publications/detail/fips/180/4/final" >Secure Hash Standard csrc.nist.gov</a> / <a class="internal_link" href="/documents/NIST.FIPS.180-4.pdf">NIST.FIPS.180-4.pdf local download</a>.<br/>

&emsp;I have to admit that at the first attempt I did use inappropriate data types like storing single bit information in int what was huge waste of memory and performing calculations not on the bit level but doing everything by hand on high abstraction plane was not the fastest way, but anyhow it was working fine for this purporse because it didn't have any impact on speed, mostly due that networking is slow itself due to latency.<br/>

&emsp;When progressing with actually basic C++ knowledge I wanted to rewrite the code to make it right using 8-bit data types and bit manipulations to save memory and make it faster.<br/>
At the very beginning it was very tricky when choosing the correct datatype to use, because my first idea was to manipulate directly on std::string or c-style char[] which both are arrays to not waste time for moving data to some other array type.<br/>

Unfortunately first issue occured and it was hard to solve it. When looking into the code and part where we move data from 8-bit chunks to 32-bit words, I didn't use bitwise OR like it's present but just addition at the beginning:

<div class = "code_short"><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">+</span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]))&lt;</span><span class="sc4">24</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">16</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">2</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">
    </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc11">temp1</span><span class="sc10">|</span><span class="sc11">temp2</span><span class="sc10">|</span><span class="sc11">temp3</span><span class="sc10">|</span><span class="sc11">temp4</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</div>
What is going on there, is the conversion and merging 8-bit data chunks into 32-bit word data structures. Problem starts in the beginning where we put bit '1' right after the message:
<div class = "code_short"><span class="sc2">// Adding bit 1 right behing the message and increasing its length for below calculations.
</span><span class="sc0"></span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0x80</span><span class="sc10">);</span>
</div>
When <span class="code_quote">message</span> is an array of 8-bit signed values, kind of getting out of range happens and current value is -128 (<span class="quote">0b10000000</span> for 8-bits) so we are right at the beginning of range of the signed 8-bit datatype which is between -128 and 127. It happens because MSB (Most Significant Bit) so the bit most on the left indicates if value is positive (0) or negative (1). All right, but how does it look like in a bit representation when getting into 32-bit datatype like <span class="code_quote">uint32_t</span>?:<br/>
<span class="quote">0b11111111111111111111111110000000</span><br/>
..and this is completely not what we were going to achieve, although this behavior is correct in mathematical and logical sense. To explain this we need to recall how negative binary numbers are calculated with <a class="external_link" target="_blank" href="https://en.wikipedia.org/wiki/Two%27s_complement" >"Two's complement"</a> rule. Saying shortly we need to invert all the bits 0 to 1 and 1 to 0, in the end we add 1 to the result. To convert negative value to positive one we naturally do the opposite, subtract 1 and invert the bits. Let's take a look on the above example, where we know 0x80 is -128 in decimal:<br/>
<span class="quote">0x80</span> -> <span class="quote">0b10000000</span> ->(minus 1) <span class="quote">0b01111111</span> ->(invert) <span class="quote">0b10000000</span> -> <span class="quote">128</span><br/>
After the calculation we know our value is 128 (negative). Do we achieve the same when converting above <span class="code_quote">uint32_t</span> value? Sure:<br/>
<div style="text-align:left"><span class="quote">0xFFFFFF80</span> -> <span class="quote">0b11111111111111111111111110000000</span> ->(minus 1) <span class="quote">0b11111111111111111111111101111111</span> ->(invert) <span class="quote">0b00000000000000000000000010000000</span> -> <span class="quote">128</span></div>
Let's take positive number 7 as an full example and convert it to negative number:<br/>
<span class="quote">7</span> -> <span class="quote">0b00000111</span> ->(invert) <span class="quote">0b11111000</span> ->(plus 1) <span class="quote">0b11111001</span> -> <span class="quote">0xF9</span><br/>
Please notice if we would put this number into the calculator it will show us number 249. What is the number of values that 8-bit datatype can store? 256 (unsigned range -128 - 127 or signed 0 - 255 (and including 0 -> 0b00000000)). 249 - 256 = -7.<br/>
..and the way back:<br/>
<span class="quote">0xF9</span> -> <span class="quote">0b11111001</span> ->(minus 1) <span class="quote">0b11111000</span> ->(invert) <span class="quote">0b00000111</span> -> <span class="quote">7</span><br/>
It turns out that cure for this is to cast the value to the same type but unsigned variant and only then cast it to larger datatype.</br>
In my program it happens at the very beginning when transfering data from <span class="code_quote">char **argv</span> to <span class="code_quote">std::vector &#60;unsigned char&#62;</span> and such value will look finally like this: <span class="quote">0b00000000000000000000000010000000</span>.<br/>
Going back to conversion and merging 8-bit data chunks into 32-bit words, when testing the code on "hello world" string, when it comes to generating third word from "rld" substring and added 0x80, I kept getting these values:<br/>
1: <span class="quote">'r'</span> -> <span class="quote">0x72</span> -> <span class="quote">0b01110010</span> ->(shift left 24 bits) -> <span class="quote">0b01110010000000000000000000000000</span><br/>
2: <span class="quote">'l'</span> -> <span class="quote">0x6C</span> -> <span class="quote">0b01101100</span> ->(shift left 16 bits) -> <span class="quote">0b00000000011011000000000000000000</span><br/>
3: <span class="quote">'d'</span> -> <span class="quote">0x64</span> -> <span class="quote">0b01100100</span> ->(shift left 8 bits) -> <span class="quote">0b00000000000000000110010000000000</span><br/>
4: <span class="quote">put 1b</span> -> <span class="quote">0x80</span> -> <span class="quote">0b10000000</span> ->(no shift) -> <span class="quote">0b11111111111111111111111110000000</span></br>
When I was using addition then I got this value:
<span class="quote">0b01110010011011000110001110000000</span>,<br/>
<div style="text-align:left;">nothing suspicious at the first look when comparing to the correct output:
<span class="quote">0b01110010011011000110010010000000</span>,</div>
<div style="text-align:left;">but when I did change addition to OR it was clearly visible something went wrong:
<span class="quote">0b11111111111111111111111110000000</span>.</div><br/>
&emsp;Below code is complete standalone console program for generating only SHA256 or HMAC SHA256 hash with time measure function Stopwatch (source: <a class="external_link" target="_blank" href="https://ccc.codes/" >C++ Crash Course written by Josh Lospinoso</a>, chapter 12, listing 12-25, page 390 in the third printing), but obviously its purpose is rather to be used as internal function or library of complex program.<br/>
I'm not copying here alogrithms descriptions because they're included under the links above.

<br/><br/>
<button id="changeCodeHeightBtn_id_1" onclick="change_code_height('1')" style="float:right; width:100px;">100% height</button>
<br/>

<div id="code_id_1" class = "code_long"><span class="sc9">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;chrono&gt;
</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">Stopwatch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Stopwatch</span><span class="sc10">(</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">nanoseconds</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">result</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">:</span><span class="sc11">result</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">result</span><span class="sc0"> </span><span class="sc10">},</span><span class="sc0">
        </span><span class="sc11">start</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">system_clock</span><span class="sc10">::</span><span class="sc11">now</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc10">{}</span><span class="sc0">
    </span><span class="sc10">~</span><span class="sc11">Stopwatch</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">result</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">system_clock</span><span class="sc10">::</span><span class="sc11">now</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">start</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc16">private</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">nanoseconds</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">result</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">time_point</span><span class="sc10">&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">system_clock</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">start</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)|(</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">32</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;&amp;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

    </span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">();</span><span class="sc0">

    </span><span class="sc2">// Adding bit 1 right behing the message and increasing its length for below calculations.
</span><span class="sc0">    </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0x80</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">message_size</span><span class="sc10">++;</span><span class="sc0">
    
    </span><span class="sc2">// Reserving space basing on current message length to be divisible by 512 bits (64 bytes) - 64 bits for bit message length at the end.
</span><span class="sc0">    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc4">56</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">reserve</span><span class="sc10">(</span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">       
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">reserve</span><span class="sc10">(</span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc2">// Back to original message length.
</span><span class="sc0">    </span><span class="sc11">message_size</span><span class="sc10">--;</span><span class="sc0">
        
    </span><span class="sc2">// Counting bit message length to 64 bit long variable and pushing back 8 bits for each iteration from it.
</span><span class="sc0">    </span><span class="sc16">uint64_t</span><span class="sc0"> </span><span class="sc11">message_bit_size</span><span class="sc10">{</span><span class="sc11">message_size</span><span class="sc10">*</span><span class="sc4">8</span><span class="sc10">};</span><span class="sc0">  
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">{</span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++){</span><span class="sc0">
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc11">message_bit_size</span><span class="sc10">&gt;&gt;(</span><span class="sc4">7</span><span class="sc10">-</span><span class="sc11">i</span><span class="sc10">)*</span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">   
    
    </span><span class="sc2">// Const hash values
</span><span class="sc0">    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x6a09e667</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xbb67ae85</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x3c6ef372</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xa54ff53a</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x510e527f</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h5</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x9b05688c</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h6</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x1f83d9ab</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h7</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x5be0cd19</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc2">// Round constants.
</span><span class="sc0">    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">round_table</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0"> 
    </span><span class="sc4">0x428a2f98</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x71374491</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xb5c0fbcf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xe9b5dba5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x3956c25b</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x59f111f1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x923f82a4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xab1c5ed5</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0xd807aa98</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x12835b01</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x243185be</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x550c7dc3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x72be5d74</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x80deb1fe</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x9bdc06a7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc19bf174</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0xe49b69c1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xefbe4786</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x0fc19dc6</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x240ca1cc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x2de92c6f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x4a7484aa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x5cb0a9dc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x76f988da</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x983e5152</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xa831c66d</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xb00327c8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xbf597fc7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc6e00bf3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xd5a79147</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x06ca6351</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x14292967</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x27b70a85</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x2e1b2138</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x4d2c6dfc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x53380d13</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x650a7354</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x766a0abb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x81c2c92e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x92722c85</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0xa2bfe8a1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xa81a664b</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc24b8b70</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc76c51a3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xd192e819</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xd6990624</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xf40e3585</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x106aa070</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x19a4c116</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x1e376c08</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x2748774c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x34b0bcb5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x391c0cb3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x4ed8aa4a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x5b9cca4f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x682e6ff3</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x748f82ee</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x78a5636f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x84c87814</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x8cc70208</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x90befffa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xa4506ceb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xbef9a3f7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc67178f2</span><span class="sc0"> 
    </span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc2">// Modulo const value.
</span><span class="sc0">    </span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">4294967296</span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc2">// Push every 512 bit chunk of message table to another table with word size per one entry (4x8 bit -&gt; 32 bit) and operate.
</span><span class="sc0">    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">{};</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">();</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">message_chunk</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">reserve</span><span class="sc10">(</span><span class="sc4">64</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">+</span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">  
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">24</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">16</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">2</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">                                   
            </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc11">temp1</span><span class="sc10">|</span><span class="sc11">temp2</span><span class="sc10">|</span><span class="sc11">temp3</span><span class="sc10">|</span><span class="sc11">temp4</span><span class="sc10">);</span><span class="sc0">            
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">// Adding 48 more zero words to fully initialize 64 words.
</span><span class="sc0">        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">{};</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">48</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> 
            </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        
        </span><span class="sc2">// Modifying added zeroed words.
</span><span class="sc0">        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">{</span><span class="sc4">16</span><span class="sc10">};</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">s0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">7</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">18</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(((</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc4">3</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">s1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">17</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">19</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(((</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc4">10</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(((((</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">-</span><span class="sc4">16</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">s0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">-</span><span class="sc4">7</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">s1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        
        </span><span class="sc2">// Compression.
</span><span class="sc0">        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h0</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h1</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h2</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h3</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h4</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h5</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h6</span><span class="sc10">};</span><span class="sc0">    
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h7</span><span class="sc10">};</span><span class="sc0">
        
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">{</span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">S1</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">6</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">11</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">25</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">{(</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(~</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;((((((((</span><span class="sc11">h</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">S1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">round_table</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">S0</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">13</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">22</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">maj</span><span class="sc0"> </span><span class="sc10">{(</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;((</span><span class="sc11">S0</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">maj</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc11">h</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">g</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">c</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">   
        
        </span><span class="sc2">// Modifying final values.
</span><span class="sc0">        </span><span class="sc11">h0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h0</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h1</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h3</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h4</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h5</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h5</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h6</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h6</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h7</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h7</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">h</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Concatenating and returning final hash as vector of unsigned char type.
</span><span class="sc0">    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">*&gt;</span><span class="sc0"> </span><span class="sc11">vec_sha256_hashes</span><span class="sc0"> </span><span class="sc10">{&amp;</span><span class="sc11">h0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h6</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h7</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">vec_sha256</span><span class="sc10">;</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">vec_sha256_hashes</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">)&gt;&gt;</span><span class="sc4">24</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">)&gt;&gt;</span><span class="sc4">16</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">)&gt;&gt;</span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">));</span><span class="sc0">        
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">vec_sha256</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">HMAC_SHA256</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;&amp;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;&amp;</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">()&gt;</span><span class="sc4">64</span><span class="sc10">)</span><span class="sc0"> 
        </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc2">// Key part: adding zeroes to make it divisible by 512 bits.
</span><span class="sc0">    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc2">// Key xor ipad const value.
</span><span class="sc0">    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ipad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">0x36</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">()};</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">^=</span><span class="sc0"> </span><span class="sc11">ipad</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Appending text message to key_ipad and hashing.
</span><span class="sc0">    </span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc10">(</span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">());</span><span class="sc0">    
    </span><span class="sc11">key_ipad</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">key_ipad</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc2">// Key xor opad const value.
</span><span class="sc0">    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">opad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">0x5c</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">key_opad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">()};</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">key_opad</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">^=</span><span class="sc0"> </span><span class="sc11">opad</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Concatenating key_opad with the first_hash.
</span><span class="sc0">    </span><span class="sc11">key_opad</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">key_opad</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">());</span><span class="sc0">
    </span><span class="sc11">key_opad</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">key_opad</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">key_opad</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">**</span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"- for only SHA256: SHA256 [text], for example:\n"</span><span class="sc0">
                        </span><span class="sc6">"SHA256 \"hello world\"\n"</span><span class="sc0">      
                        </span><span class="sc6">"SHA256 hello\n"</span><span class="sc0">                    
                        </span><span class="sc6">"- for HMAC SHA256: SHA256 [text] -h [secret key]\n"</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"No arguments provided, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">])==</span><span class="sc6">"-h"</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"No secret key provided, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">       
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">              
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">])!=</span><span class="sc6">"-h"</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"Wrong syntax, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0"> 
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">              
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">])!=</span><span class="sc6">"-h"</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"Wrong syntax, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"Too many arguments, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Time measure scope.
</span><span class="sc0">    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">nanoseconds</span><span class="sc0"> </span><span class="sc11">elapsed</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">       
    </span><span class="sc11">Stopwatch</span><span class="sc0"> </span><span class="sc11">stopwatch</span><span class="sc10">{</span><span class="sc11">elapsed</span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">    
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">;</span><span class="sc0">    
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]++);</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]++);</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">HMAC_SHA256</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">)){</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">&gt;&gt;</span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">++</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc4">0xF</span><span class="sc10">);</span><span class="sc0">         
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">        
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">;</span><span class="sc0">    
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]++);</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">)){</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">&gt;&gt;</span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">++</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc4">0xF</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc10">}</span><span class="sc0">       
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// Stopwatch.
</span><span class="sc0">    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\nElapsed: %g s.\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">elapsed</span><span class="sc10">.</span><span class="sc11">count</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">1'000'000'000.</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span>
</div>
</div>
