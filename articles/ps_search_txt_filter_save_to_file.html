<span class = "content_title"> <a href="#/windows"> Windows</a> / <span class = "content_title_current">PowerShell search txt, filter and save to a file</span> </span>
<hr/>
<br/>

<div>
Source file sample:
<div id="code_id_1" class ="code_short">6316042           0x00003003         DP                Temp.txt
6316043           0x00003004         DP                containers-client.log
6316044           0x00003005         DP                deployment_status.st
6316045           0x00003006         DP                File4.avi
6316046           0x00003007         DP                winlog.mn
6316047           0x00003008         DP                File1.avi
6316048           0x00003009         DP                cachelib.dll
</div>

<div id="code_id_1" class ="code_short" style = "background-color:#012456"><span class="sc9">Get-Content</span><span class="sc0"> </span><span class="sc3">'.\DataPartH01F07 Found.txt'</span><span class="sc0"> </span><span class="sc6">|</span><span class="sc0"> </span><span class="sc6">%</span><span class="sc0"> </span><span class="sc6">{</span><span class="sc0">
    </span><span class="sc8">if</span><span class="sc6">(</span><span class="sc5">$_</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc7">Like</span><span class="sc0"> </span><span class="sc2">"*.avi"</span><span class="sc6">){</span><span class="sc0">
        </span><span class="sc5">$var</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc5">$_</span><span class="sc6">.</span><span class="sc7">IndexOf</span><span class="sc6">(</span><span class="sc2">"DP"</span><span class="sc6">);</span><span class="sc0"> 
        </span><span class="sc8">for</span><span class="sc6">(</span><span class="sc5">$i</span><span class="sc6">=</span><span class="sc5">$var</span><span class="sc6">+</span><span class="sc4">3</span><span class="sc6">;</span><span class="sc0"> </span><span class="sc5">$i</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc7">lt</span><span class="sc0"> </span><span class="sc5">$_</span><span class="sc6">.</span><span class="sc7">length</span><span class="sc6">;</span><span class="sc0"> </span><span class="sc5">$i</span><span class="sc6">++){</span><span class="sc0">
            </span><span class="sc8">if</span><span class="sc6">(</span><span class="sc5">$_</span><span class="sc6">.</span><span class="sc7">SubString</span><span class="sc6">(</span><span class="sc5">$i</span><span class="sc6">,</span><span class="sc4">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc7">ne</span><span class="sc0"> </span><span class="sc2">" "</span><span class="sc6">){</span><span class="sc0">
                </span><span class="sc5">$var</span><span class="sc6">=</span><span class="sc5">$i</span><span class="sc6">;</span><span class="sc0">
                </span><span class="sc8">break</span><span class="sc6">;</span><span class="sc0">
            </span><span class="sc6">}</span><span class="sc0">
        </span><span class="sc6">}</span><span class="sc0">
        </span><span class="sc9">Out-File</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc7">FilePath</span><span class="sc0"> </span><span class="sc6">.</span><span class="sc0">\</span><span class="sc7">PS_report</span><span class="sc6">.</span><span class="sc7">txt</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc7">Append</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc7">InputObject</span><span class="sc0"> </span><span class="sc5">$_</span><span class="sc6">.</span><span class="sc7">SubString</span><span class="sc6">(</span><span class="sc5">$var</span><span class="sc6">);</span><span class="sc0">
    </span><span class="sc6">}</span><span class="sc0">
</span><span class="sc6">}</span>
</div>
<br/>


</div>