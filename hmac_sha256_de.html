<span class = "content_title"> <a href="#/cpp"> C++</a> / <span class = "content_title_current">HMAC SHA-256, something about bit level data operations and stopwatch <span style="color:#f00;">DE Version</span></span></span>
<hr/>
<br/>

<div>
&emsp;Für eines meiner Projekte im Zusammenhang mit API-Netzwerken, bei welchem ich <a class="external_link" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/winhttp/using-the-winhttp-c-c---api" >WinHTTP</a> und <a class="external_link" target="_blank" href="https://doc.qt.io/qt-6/qtnetwork-index.html" >QT Network</a> später verwendet habe, ich habe entschieden um HMAC SHA-256 Verschlüsselungsfunktion selbst hinzuzufügen, weil ich keine fertige Lösung benutzen wollte, sondern etwas lernen wollte und weil es eine großartige Gelegenheit für Praxis der Datenmanipulation ist.<br/>
&emsp;HMAC ist eine Abkürzung für "Hash-based Message Authentication Code" (Hash-Nachrichtenauthentifizierungscode) welches Zweck ist beidene Authentizität als auch die Integrität der Nachricht zu wahren, durch verkürzte Einweg-Hash-Zeichenfolge mit angegebene Hashfunktion, die einen geheimen Schlüssel benutzt, der ist nur für Absender und Empfänger bekannt.<br/>
&emsp;SHA-256 ist Secure Hash Algorithm (Sicherer Hash-Algorithmus), der zur SHA-2 Algorithmenfamilie gehört und derzeit als sehr sicher gilt, besonders in einem solchen Fall wenn er ist kurz bevor eine Message senden erstellt.<br/>
Viele Wissen have ich auf dieser hilfreichen Webseite gefunden: <a class="external_link" target="_blank" href="https://blog.boot.dev/cryptography/hmac-and-macs-in-jwts" >HMAC blog.boot.dev</a> / <a class="external_link" target="_blank" href="https://blog.boot.dev/cryptography/how-sha-2-works-step-by-step-sha-256" >SHA-256 blog.boot.dev</a> aber ich habe auch aus die offizielen Quellen gelernt: <a class="external_link" target="_blank" href="https://csrc.nist.gov/publications/detail/fips/198/1/final" >HMAC csrc.nist.gov</a> /  <a class="internal_link" href="/documents/NIST.FIPS.198-1.pdf">NIST.FIPS.198-1.pdf lokal herunterladen</a>  and <a class="external_link" target="_blank" href="https://csrc.nist.gov/publications/detail/fips/180/4/final" >Secure Hash Standard csrc.nist.gov</a> / <a class="internal_link" href="/documents/NIST.FIPS.180-4.pdf">NIST.FIPS.180-4.pdf lokal herunterladen</a>.<br/>
Ich muss zugeben dass ich beim erste Probe unterschiedlichen Datentypen benutzt habe, so speichern einzel Bitinformationen als int, was war eine riesige Speicherverschwendung und keine Operationen auf eine Bitebene durchführen, statt alles manuell, auf höhe Abstraktionsebene machen war nicht der schnellste Weg, aber wie auch immer es hat gut für dessen Zweck funktionert, weil es hatte keine Auswirkung auf die Geschwindigkeit, hauptsächlich weil das Netzwerk selbst aufgrund der Latenz langsam ist.<br/>

Als ich mit tatsätzlich den grundelegenden C++ Wissen fortfahre, ich wollte den Code neu schreiben um ihn mit 8-Bit Datentypen und Bitmanipulationen korrekt zu machen und um Speichern zu sparen und ihn schneller zu machen. <br/>
Ganz am Anfang war es sehr schwierig um richtig Datentyp auszuwählen, weil meine erste Idee war um direkt an std::string oder C-Stil char[] die beide Array sind zu manipulieren, um die Zeit nicht zu verschwenden, zu die Dateien in manche anderem Datentyp umziehen.<br/>

Leider ist ein erster Fehler aufgetreten und es war schwierig, es zu lösen. Wann man auf dem Code und dem Teil schaut, wo wir die Daten von die 8-Bit Datenbrocken nach 32-Bit Words verschieben, habe ich wie dort vorlegen ist kein bitweises ODER (OR) verwendet, sondern die Addition am Anfang:

<div class = "code_short"><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">+</span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]))&lt;</span><span class="sc4">24</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">16</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">2</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">
    </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc11">temp1</span><span class="sc10">|</span><span class="sc11">temp2</span><span class="sc10">|</span><span class="sc11">temp3</span><span class="sc10">|</span><span class="sc11">temp4</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</div>
Was hier geschieht, ist die Konvertierung und Zusammenführung von 8-Bit Datenbrocken in 32-Bit Wortdatenstrukturen. Das Problem beginnt neben dem Start wo wir bit '1' gleich nach der Nachricht setzen:
<div class = "code_short"><span class="sc2">// Adding bit 1 right behing the message and increasing its length for below calculations.
</span><span class="sc0"></span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0x80</span><span class="sc10">);</span>
</div>
Wenn die <span class="code_quote">message</span> ein signed 8-Bit-Wert Array ist, etwas wie außerhalb des Bereich passiert und aktuell Wert ist -128 (<span class="quote">0b10000000</span> für 8-Bit) also sind wir tatsätzlich am Anfang von dem Bereich des signed 8-Bit-Datentyp, der zwischen -128 und 127 ist. Es passiert, weil MSB (Most Significant Bit - Höchstwertiges Bit) also das Bit, das ist am weitesten links, es bezeichnet ob der Wert positiv (1) oder negativ (0) ist. Na ja, aber wie sieht es aus in eine Bit-Präsentation wenn man die in einen 32-Bit-Datentyp wie <span class="code_quote">uint32_t</span> einsetzt?:<br/>
<span class="quote">0b11111111111111111111111110000000</span><br/>
..und das ist ganz unterschiedlich von was wir erreichen wollten, obwohl dieses Verhalten in mathematischer und logischer Sinn Korrekt ist. Um das zu erklären, müssen wir uns abrüfen wie negativ Binärzahlen mit der <a class="external_link" target="_blank" href="https://en.wikipedia.org/wiki/Two%27s_complement" >"Two's complement"</a> Regel berechnet werden.
Kurz gesagt, wir müssen alle Bits von 0 nach 1 und von 1 nach 0 invertieren, am Ende addieren wir 1 zum Ergebnis. Um einen negativen Wert zu einen positiv umzuwandeln, machen wir natürlich das Gegenteil, subtrahieren 1 und invertieren die Bits. Schauen wir uns das obige Beispiel an, in dem wir wissen, dass 0x80 dezimal -128 ist:<br/>
<span class="quote">0x80</span> -> <span class="quote">0b10000000</span> ->(subtrahiere 1) <span class="quote">0b01111111</span> ->(invertiere) <span class="quote">0b10000000</span> -> <span class="quote">128</span><br/>
Nach der Berechnung wissen wir, dass unser Wert 128 (negativ) ist. Werden wir den gleichen erriechen wenn den oben gennanten <span class="code_quote">uint32_t</span> Wert convertieren? Sicher:<br/>
<div style="text-align:left"><span class="quote">0xFFFFFF80</span> -> <span class="quote">0b11111111111111111111111110000000</span> ->(subtrahiere 1) <span class="quote">0b11111111111111111111111101111111</span> ->(invertiere) <span class="quote">0b00000000000000000000000010000000</span> -> <span class="quote">128</span></div>
Nehmen wir die positive Zahl 7 als ein vollständiges Beispiel und wandeln wir sie zu eine negative Zahl um:<br/>
<span class="quote">7</span> -> <span class="quote">0b00000111</span> ->(invertiere) <span class="quote">0b11111000</span> ->(addiere 1) <span class="quote">0b11111001</span> -> <span class="quote">0xF9</span><br/>
Bitte beachten Sie, wenn wir diese Nummer in den Rechner eingeben würden, wird er die 249 Nummer uns anzeigen. Was ist die Nummer der Werten, der 8-Bit Datentyp speichern kann? 256 (unsigned Bereich -128 - 127 oder signed 0 - 255 (auch einschließlich 0 -> 0b00000000)). 249 - 256 = -7.<br/>
..und es andersherum tun:<br/>
<span class="quote">0xF9</span> -> <span class="quote">0b11111001</span> ->(subtrahiere 1) <span class="quote">0b11111000</span> ->(invertiere) <span class="quote">0b00000111</span> -> <span class="quote">7</span><br/>
Es stellt sich heraus, dass die Lösung für das, ist den Wert in den gleichen Typ, aber die unsigned Variante umwandeln und er nur dann in einen größeren Datentyp umwandeln.</br>
In meinem Programm, tut es ganz am Anfang wann wir die Daten aus <span class="code_quote">char **argv</span> zu <span class="code_quote">std::vector &#60;unsigned char&#62;</span> übertragen und solche Werte werden letztendlich so aussehen: <span class="quote">0b00000000000000000000000010000000</span>.<br/>
Zurück zur 8-Bit Datenbrocken nach 32-Bit Wortdatenstrukturen konvertieren und zusammenführen, wann den Code mit "hello world" Zeichenfolge prüfen, wenn es um erstellung des dritten Wört von der "rld" Teilzeichenfolge and addiert 0x80 geht, ich habe immer wieder diese Werte bekommt:<br/>
1: <span class="quote">'r'</span> -> <span class="quote">0x72</span> -> <span class="quote">0b01110010</span> ->(Linksverschiebung 24 bits) -> <span class="quote">0b01110010000000000000000000000000</span><br/>
2: <span class="quote">'l'</span> -> <span class="quote">0x6C</span> -> <span class="quote">0b01101100</span> ->(Linksverschiebung 16 bits) -> <span class="quote">0b00000000011011000000000000000000</span><br/>
3: <span class="quote">'d'</span> -> <span class="quote">0x64</span> -> <span class="quote">0b01100100</span> ->(Linksverschiebung 8 bits) -> <span class="quote">0b00000000000000000110010000000000</span><br/>
4: <span class="quote">put 1b</span> -> <span class="quote">0x80</span> -> <span class="quote">0b10000000</span> ->(ohne die Verschiebung) -> <span class="quote">0b11111111111111111111111110000000</span></br>
<div style="text-align:left;">Als ich die Addierung verwendet habe, have ich dieser Wert erhalten:
<span class="quote">0b01110010011011000110001110000000</span>,</div>
<div style="text-align:left;">nichts Verdächtiges auf den ersten Blick wann mit der richtigen Ausgabe vergleichen: 
<span class="quote">0b01110010011011000110010010000000</span>,</div>
<div style="text-align:left;">aber wenn ich addiere zu dem logischen OR ändern habe, es war deutlich sichtbar, dass etwas schlecht gegangen ist:
<span class="quote">0b11111111111111111111111110000000</span>.</div><br/>
&emsp;Der folgende Code ist das vollständige und eigenständige Programm für nur SHA-256 oder HMAC SHA-256 Hash-Funktion Erstellung mit der Zeitmessfunktion, aber natürlich ihr Zweck ist eher um als eine innere Funktion oder eine Bibliothek eines komplexen Programms zu verwenden werden.<br/>
Ich kopiere hier keine Algorithmenbeschreibungen, da sie unter den obigen Links gefügt sind.

<br/><br/>
<button id="buttoncodeheightid" onclick="change_code_height();" style="float:right; width:100px;">100% height</button>
<br/>

<div id="codeid" class = "code_long"><span class="sc9">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;chrono&gt;
</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">Stopwatch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Stopwatch</span><span class="sc10">(</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">nanoseconds</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">result</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">:</span><span class="sc11">result</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">result</span><span class="sc0"> </span><span class="sc10">},</span><span class="sc0">
        </span><span class="sc11">start</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">system_clock</span><span class="sc10">::</span><span class="sc11">now</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc10">{}</span><span class="sc0">
    </span><span class="sc10">~</span><span class="sc11">Stopwatch</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">result</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">system_clock</span><span class="sc10">::</span><span class="sc11">now</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">start</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc16">private</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">nanoseconds</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">result</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">time_point</span><span class="sc10">&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">system_clock</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">start</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)|(</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">32</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;&amp;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

    </span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">();</span><span class="sc0">

    </span><span class="sc2">// Adding bit 1 right behing the message and increasing its length for below calculations.
</span><span class="sc0">    </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0x80</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">message_size</span><span class="sc10">++;</span><span class="sc0">
    
    </span><span class="sc2">// Reserving space basing on current message length to be divisible by 512 bits (64 bytes) - 64 bits for bit message length at the end.
</span><span class="sc0">    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc4">56</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">reserve</span><span class="sc10">(</span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">       
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">reserve</span><span class="sc10">(</span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">message_size</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc2">// Back to original message length.
</span><span class="sc0">    </span><span class="sc11">message_size</span><span class="sc10">--;</span><span class="sc0">
        
    </span><span class="sc2">// Counting bit message length to 64 bit long variable and pushing back 8 bits for each iteration from it.
</span><span class="sc0">    </span><span class="sc16">uint64_t</span><span class="sc0"> </span><span class="sc11">message_bit_size</span><span class="sc10">{</span><span class="sc11">message_size</span><span class="sc10">*</span><span class="sc4">8</span><span class="sc10">};</span><span class="sc0">  
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">{</span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++){</span><span class="sc0">
        </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc11">message_bit_size</span><span class="sc10">&gt;&gt;(</span><span class="sc4">7</span><span class="sc10">-</span><span class="sc11">i</span><span class="sc10">)*</span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">   
    
    </span><span class="sc2">// Const hash values
</span><span class="sc0">    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x6a09e667</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xbb67ae85</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x3c6ef372</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xa54ff53a</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x510e527f</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h5</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x9b05688c</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h6</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x1f83d9ab</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h7</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x5be0cd19</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc2">// Round constants.
</span><span class="sc0">    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">round_table</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0"> 
    </span><span class="sc4">0x428a2f98</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x71374491</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xb5c0fbcf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xe9b5dba5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x3956c25b</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x59f111f1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x923f82a4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xab1c5ed5</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0xd807aa98</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x12835b01</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x243185be</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x550c7dc3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x72be5d74</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x80deb1fe</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x9bdc06a7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc19bf174</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0xe49b69c1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xefbe4786</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x0fc19dc6</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x240ca1cc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x2de92c6f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x4a7484aa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x5cb0a9dc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x76f988da</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x983e5152</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xa831c66d</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xb00327c8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xbf597fc7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc6e00bf3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xd5a79147</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x06ca6351</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x14292967</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x27b70a85</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x2e1b2138</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x4d2c6dfc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x53380d13</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x650a7354</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x766a0abb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x81c2c92e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x92722c85</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0xa2bfe8a1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xa81a664b</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc24b8b70</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc76c51a3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xd192e819</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xd6990624</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xf40e3585</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x106aa070</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x19a4c116</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x1e376c08</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x2748774c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x34b0bcb5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x391c0cb3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x4ed8aa4a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x5b9cca4f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x682e6ff3</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0x748f82ee</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x78a5636f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x84c87814</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x8cc70208</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x90befffa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xa4506ceb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xbef9a3f7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0xc67178f2</span><span class="sc0"> 
    </span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc2">// Modulo const value.
</span><span class="sc0">    </span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">4294967296</span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc2">// Push every 512 bit chunk of message table to another table with word size per one entry (4x8 bit -&gt; 32 bit) and operate.
</span><span class="sc0">    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">{};</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">();</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">message_chunk</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">reserve</span><span class="sc10">(</span><span class="sc4">64</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">+</span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">  
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">24</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">16</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">2</span><span class="sc10">]))&lt;&lt;</span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;(</span><span class="sc11">message</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">+</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">                                   
            </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc11">temp1</span><span class="sc10">|</span><span class="sc11">temp2</span><span class="sc10">|</span><span class="sc11">temp3</span><span class="sc10">|</span><span class="sc11">temp4</span><span class="sc10">);</span><span class="sc0">            
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">// Adding 48 more zero words to fully initialize 64 words.
</span><span class="sc0">        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">{};</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">48</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> 
            </span><span class="sc11">message_chunk</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        
        </span><span class="sc2">// Modifying added zeroed words.
</span><span class="sc0">        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">{</span><span class="sc4">16</span><span class="sc10">};</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">s0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">7</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">18</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(((</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc4">3</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">s1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">17</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc4">19</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(((</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc4">10</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(((((</span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">-</span><span class="sc4">16</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">s0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">-</span><span class="sc4">7</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">s1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        
        </span><span class="sc2">// Compression.
</span><span class="sc0">        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h0</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h1</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h2</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h3</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h4</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h5</span><span class="sc10">};</span><span class="sc0">
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h6</span><span class="sc10">};</span><span class="sc0">    
        </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">h</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">h7</span><span class="sc10">};</span><span class="sc0">
        
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">size_t</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">{</span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">S1</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">6</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">11</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">25</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">{(</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(~</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;((((((((</span><span class="sc11">h</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">S1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">round_table</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">message_chunk</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">S0</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">13</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">rightRotate</span><span class="sc10">(</span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">22</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">maj</span><span class="sc0"> </span><span class="sc10">{(</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc16">uint32_t</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">&gt;((</span><span class="sc11">S0</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">maj</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">)};</span><span class="sc0">
            </span><span class="sc11">h</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">g</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">temp1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">c</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">temp1</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">temp2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">   
        
        </span><span class="sc2">// Modifying final values.
</span><span class="sc0">        </span><span class="sc11">h0</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h0</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h1</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h3</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h4</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h5</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h5</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h6</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h6</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">h7</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">h7</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">h</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">moduloVal</span><span class="sc10">;</span><span class="sc0">
        
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Concatenating and returning final hash as vector of unsigned char type.
</span><span class="sc0">    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">uint32_t</span><span class="sc10">*&gt;</span><span class="sc0"> </span><span class="sc11">vec_sha256_hashes</span><span class="sc0"> </span><span class="sc10">{&amp;</span><span class="sc11">h0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h6</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">h7</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">vec_sha256</span><span class="sc10">;</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">vec_sha256_hashes</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">)&gt;&gt;</span><span class="sc4">24</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">)&gt;&gt;</span><span class="sc4">16</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">)&gt;&gt;</span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">vec_sha256</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">ch</span><span class="sc10">));</span><span class="sc0">        
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">vec_sha256</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">HMAC_SHA256</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;&amp;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;&amp;</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">()&gt;</span><span class="sc4">64</span><span class="sc10">)</span><span class="sc0"> 
        </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc2">// Key part: adding zeroes to make it divisible by 512 bits.
</span><span class="sc0">    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">size</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">64</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc2">// Key xor ipad const value.
</span><span class="sc0">    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ipad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">0x36</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">()};</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">^=</span><span class="sc0"> </span><span class="sc11">ipad</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Appending text message to key_ipad and hashing.
</span><span class="sc0">    </span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc10">(</span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">());</span><span class="sc0">    
    </span><span class="sc11">key_ipad</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">key_ipad</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc2">// Key xor opad const value.
</span><span class="sc0">    </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">opad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">0x5c</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">key_opad</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">()};</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">key_opad</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">^=</span><span class="sc0"> </span><span class="sc11">opad</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Concatenating key_opad with the first_hash.
</span><span class="sc0">    </span><span class="sc11">key_opad</span><span class="sc10">.</span><span class="sc11">insert</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">key_opad</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">begin</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">key_ipad</span><span class="sc10">.</span><span class="sc11">end</span><span class="sc10">());</span><span class="sc0">
    </span><span class="sc11">key_opad</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">key_opad</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">key_opad</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">**</span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    
    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"- for only SHA256: SHA256 [text], for example:\n"</span><span class="sc0">
                        </span><span class="sc6">"SHA256 \"hello world\"\n"</span><span class="sc0">      
                        </span><span class="sc6">"SHA256 hello\n"</span><span class="sc0">                    
                        </span><span class="sc6">"- for HMAC SHA256: SHA256 [text] -h [secret key]\n"</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"No arguments provided, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">])==</span><span class="sc6">"-h"</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"No secret key provided, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">       
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">              
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">])!=</span><span class="sc6">"-h"</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"Wrong syntax, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0"> 
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">              
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">string</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">])!=</span><span class="sc6">"-h"</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"Wrong syntax, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc6">"Too many arguments, usage:\n"</span><span class="sc10">&lt;&lt;</span><span class="sc11">usage</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">// Time measure scope.
</span><span class="sc0">    </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">chrono</span><span class="sc10">::</span><span class="sc11">nanoseconds</span><span class="sc0"> </span><span class="sc11">elapsed</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">       
    </span><span class="sc11">Stopwatch</span><span class="sc0"> </span><span class="sc11">stopwatch</span><span class="sc10">{</span><span class="sc11">elapsed</span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">    
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">;</span><span class="sc0">    
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]++);</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]++);</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">HMAC_SHA256</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">)){</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">&gt;&gt;</span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">++</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc4">0xF</span><span class="sc10">);</span><span class="sc0">         
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">        
        </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">vector</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">;</span><span class="sc0">    
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">message</span><span class="sc10">.</span><span class="sc11">emplace_back</span><span class="sc10">(*</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]++);</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">auto</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">SHA256</span><span class="sc10">(</span><span class="sc11">message</span><span class="sc10">)){</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">&gt;&gt;</span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">cout</span><span class="sc10">&lt;&lt;</span><span class="sc11">std</span><span class="sc10">::</span><span class="sc11">hex</span><span class="sc10">&lt;&lt;</span><span class="sc5">static_cast</span><span class="sc10">&lt;</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">&gt;(</span><span class="sc11">ch</span><span class="sc10">++</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc4">0xF</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc10">}</span><span class="sc0">       
    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">// Stopwatch.
</span><span class="sc0">    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\nElapsed: %g s.\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">elapsed</span><span class="sc10">.</span><span class="sc11">count</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">1'000'000'000.</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span>
</div>
</div>
